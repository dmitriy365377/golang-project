# Архитектура Golang Chat Application

## Обзор

Проект построен по принципу микросервисной архитектуры с разделением ответственности между сервисами.

## Компоненты

### 1. Auth Service (Сервис Аутентификации)

**Порт:** 50051  
**Ответственность:** Управление пользователями, аутентификация и авторизация

**API Endpoints:**
- **User API:** CRUD операции с пользователями
- **Auth API:** Логин, управление токенами
- **Access API:** Проверка доступа к ресурсам

**Основные функции:**
- Создание, чтение, обновление, удаление пользователей
- Аутентификация пользователей (логин)
- Генерация и валидация JWT токенов
- Проверка прав доступа к эндпоинтам

### 2. Chat Service (Сервис Чата)

**Порт:** 50052  
**Ответственность:** Управление чатами и сообщениями

**API Endpoints:**
- **Chat API:** Создание чатов, подключение, отправка сообщений

**Основные функции:**
- Создание новых чатов
- Подключение пользователей к чатам
- Отправка и получение сообщений
- Управление участниками чатов

### 3. Chat Client (Клиентское Приложение)

**Тип:** CLI приложение  
**Ответственность:** Интерфейс для взаимодействия с сервисами

**Команды:**
- `login` - аутентификация пользователя
- `create chat <name>` - создание нового чата
- `connect <chat_id>` - подключение к существующему чату
- `send <chat_id> <message>` - отправка сообщения

## Потоки данных

### Аутентификация пользователя
1. Клиент отправляет `login` запрос к Auth Service
2. Auth Service проверяет учетные данные
3. При успехе возвращает access и refresh токены
4. Клиент сохраняет токены для последующих запросов

### Создание чата
1. Клиент отправляет `create chat` запрос через auth interceptor
2. Auth interceptor проверяет access токен через Access API
3. При успешной проверке запрос передается в Chat Service
4. Chat Service создает чат и возвращает результат

### Отправка сообщения
1. Клиент отправляет `send message` запрос через auth interceptor
2. Auth interceptor проверяет права доступа
3. Chat Service проверяет, является ли пользователь участником чата
4. Сообщение сохраняется и возвращается клиенту

## Технологии

- **Язык:** Go 1.21+
- **Протокол:** gRPC
- **Сериализация:** Protocol Buffers
- **Аутентификация:** JWT токены
- **База данных:** PostgreSQL (планируется)
- **CLI Framework:** Cobra

## Безопасность

- Все запросы к Chat Service проходят через auth interceptor
- JWT токены с ограниченным временем жизни
- Разделение access и refresh токенов
- Проверка прав доступа на уровне эндпоинтов

## Масштабируемость

- Микросервисная архитектура позволяет независимо масштабировать сервисы
- gRPC обеспечивает эффективную коммуникацию между сервисами
- Возможность добавления новых сервисов без изменения существующих
